!function(e){var t={};function s(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(o,i,function(t){return e[t]}.bind(null,i));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var o=function e(t,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=s},i=$("#game"),n=($("#newgame-btn"),$("#game-button")),a=$("#gamebar"),r=$(".top-border"),c=$(".middle-border"),l=$(".bottom-border"),u=$("#field-container"),h=($("#settings-container"),$("#scores"),16),d=10;function f(e,t){!function(e,t){var s=h*e+3*d+32,o=h*t+2*d,r=h*t+2*d,c=h*t/2-13-49,l=h*t/2-13-49;$(i).css("zoom",3),$(i).css({height:s,width:o}),$(a).css("width",r),$(u).css("height",h*e),$(n).css({"margin-left":c,"margin-right":l}),$(n).removeClass("btn-dead"),$(n).removeClass("btn-cool")}(e,t),v(t,r,"t"),function(e,t){for(var s=0;s<e;s++){$(u).append('<div class="row" id="r'.concat(s,'"></div>'));var o="#r"+s;$(o).append('<div class="border-vertical"></div>');for(var i=0;i<t;i++){var n='<div id="'.concat(s,"-").concat(i,'" class="block field"></div>');$(o).append(n)}$(o).append('<div class="border-vertical"></div>')}}(e,t),v(t,c,"i"),v(t,l,"b")}function v(e,t,s){$(t).append('<div class="border-'.concat(s,'l"></div>'));for(var o=1;o<=e;o++)$(t).append('<div class="border-horizontal"></div>');$(t).append('<div class="border-'.concat(s,'r"></div>'))}function m(e){var t=[];for(e=Math.abs(e);e>0;)t[t.length]=e%10,e=parseInt(e/10);return t}function b(e,t){return"#"+e+"-"+t}function k(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.seconds=0,this.secondsArray=[],this.interval=setInterval(function(){t.seconds++,999===t.seconds&&t.stopTimer();var e=m(t.seconds);t.timerClass(3,e[0]),t.timerClass(2,e[1]),t.timerClass(1,e[2])},1e3),this.startTs=new Date}var t,s,o;return t=e,(s=[{key:"timerClass",value:function(e,t){t=void 0===t?0:t;var s="#timer-".concat(e);if(parseInt($(s).attr("class").split("d")[2])!==t){for(var o=0;o<=9;o++)$(s).removeClass("d".concat(o));$(s).addClass("d".concat(t))}}},{key:"setTimerToZero",value:function(){this.timerClass(3,0),this.timerClass(2,0),this.timerClass(1,0)}},{key:"stopTimer",value:function(){clearInterval(this.interval)}},{key:"getFinishTime",value:function(){return(new Date-this.startTs)/1e3}}])&&k(t.prototype,s),o&&k(t,o),e}();function g(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.points=t;var s=m(this.points);this.scoreClass(3,s[0]),this.scoreClass(2,s[1]),this.scoreClass(1,s[2])}var t,s,o;return t=e,(s=[{key:"addPoint",value:function(){this.points++;var e=m(this.points);this.scoreClass(3,e[0]),this.scoreClass(2,e[1]),this.scoreClass(1,e[2]),this.points<0&&this.scoreClass(1,"-")}},{key:"removePoint",value:function(){this.points--;var e=m(this.points);this.scoreClass(3,e[0]),this.scoreClass(2,e[1]),this.scoreClass(1,e[2]),this.points<0&&this.scoreClass(1,"-")}},{key:"scoreClass",value:function(e,t){t=void 0===t?0:t;var s="#points-".concat(e);$(s).removeClass("d-");for(var o=0;o<=9;o++)$(s).removeClass("d".concat(o));$(s).addClass("d".concat(t))}}])&&g(t.prototype,s),o&&g(t,o),e}();function C(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.debugLog("Setting up Game"),this.debug=t,this.showBombs=t,this.rows,this.columns,this.bombs,this.setupGame()}var t,s,i;return t=e,(s=[{key:"setupGame",value:function(){$(r).empty(),$(c).empty(),$(u).empty(),$(l).empty();var e=parseInt($("#input-rows").val()),t=parseInt($("#input-columns").val()),s=parseInt($("#input-bombs").val());this.rows=e<8?8:e,this.columns=t<8?8:t,this.bombs=s<1?1:s,this.amountFields=this.rows*this.columns-this.bombs,this.bombsArray=this.createBombs(),this.boardArray=this.createBoardArray(),console.log("boardArray =>",this.boardArray),this.gameWon=!1,f(this.rows,this.columns),this.points=new y(this.bombs),this.timer=new p}},{key:"createBombs",value:function(){for(var e=this,t=[],s=function(s){for(var i=!1,n=void 0,a=void 0;!i;)n=Math.floor(Math.random()*e.rows),a=Math.floor(Math.random()*e.columns),t.some(function(e){return e.row===n&&e.col===a})||(i=!0);(t.push(new o(n,a)),e.showBombs)&&$("#"+n+"-"+a).toggleClass("field bomb")},i=1;i<=this.bombs;i++)s();return this.debugLog(t),t}},{key:"createBoardArray",value:function(){for(var e=[],t=0;t<this.rows;t++){e[t]=[];for(var s=0;s<this.columns;s++)e[t][s]=0}for(var o=0;o<this.bombsArray.length;o++){var i=this.bombsArray[o].row,n=this.bombsArray[o].col;e[i][n]="b",e=this.counterUpAround(i,n,e)}return e}},{key:"counterUpAround",value:function(e,t,s){return s=this.counterUp(e+1,t-1,s),s=this.counterUp(e+1,t,s),s=this.counterUp(e+1,t+1,s),s=this.counterUp(e,t-1,s),s=this.counterUp(e,t+1,s),s=this.counterUp(e-1,t-1,s),s=this.counterUp(e-1,t,s),s=this.counterUp(e-1,t+1,s)}},{key:"counterUp",value:function(e,t,s){return e>=0&&e<this.rows&&t>=0&&t<this.columns&&"number"==typeof s[e][t]&&(s[e][t]=s[e][t]+1),s}},{key:"checkNoBomb",value:function(e,t){if(isNaN(e))throw new Error("Row is NaN");if(isNaN(t))throw new Error("Col is NaN");return"b"!==this.boardArray[e][t]}},{key:"blockClicked",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";""===s&&(s=b(e,t)),e<0||e>=this.rows||t<0||t>=this.columns||$(s).hasClass("field")&&(this.checkNoBomb(e,t)?this.fieldClicked(e,t,s):this.bombClicked(e,t,s))}},{key:"fieldClicked",value:function(e,t,s){this.amountFields--;var o=this.boardArray[e][t];$(s).toggleClass("field f".concat(o," clicked")),$(s).attr("data-value",o),0===o&&this.clickFieldsAround(e,t),0===this.amountFields&&this.winGame()}},{key:"flagField",value:function(e){$(e).hasClass("flag")?(this.points.addPoint(),$(e).removeClass("flag"),$(e).addClass("field")):(this.points.removePoint(),$(e).removeClass("field"),$(e).addClass("flag"))}},{key:"checkSurroundings",value:function(e,t){for(var s=0,o=-1;o<=1;o++)for(var i=-1;i<=1;i++)this.checkNoBomb(e+o,t+i)||s++;return s}},{key:"winGame",value:function(){if(!this.gameWon){var e=this.timer.getFinishTime();console.log("time =>",e),$(n).toggleClass("btn-smiley btn-cool");for(var t=0;t<this.bombs;t++){var s=b(this.bombsArray[t].row,this.bombsArray[t].col);$(s).hasClass("flag")||this.flagField($(s))}!function(e,t){$(scores).hasClass("hidden")&&($(scores).removeClass("hidden"),$(scores).addClass("visible")),$(scores).find("tbody:last-child").append("<tr><td>".concat(e,"</td><td>").concat(t,"</td></tr>"))}(this.rows+"x"+this.columns+", "+this.bombs+" Bombs "+this.seconds,e),this.timer.stopTimer()}this.gameWon=!0}},{key:"clickFieldsAround",value:function(e,t){this.blockClicked(e-1,t-1),this.blockClicked(e-1,t),this.blockClicked(e-1,t+1),this.blockClicked(e+1,t-1),this.blockClicked(e+1,t),this.blockClicked(e+1,t+1),this.blockClicked(e,t-1),this.blockClicked(e,t+1)}},{key:"bombClicked",value:function(e,t,s){$(s).toggleClass("field bomb-red clicked"),this.timer.stopTimer(),$(n).removeClass("btn-smiley"),$(n).addClass("btn-dead");for(var o=0;o<this.bombs;o++)if(this.bombsArray[o].row!==e||this.bombsArray[o].col!==t){var i=b(this.bombsArray[o].row,this.bombsArray[o].col);$(i).toggleClass("field bomb")}var a=this;$(".flag").each(function(){var e=$(this).attr("id");console.log("id =>",e);var t=parseInt(e.split("-")[0]),s=parseInt(e.split("-")[1]);e="#"+e,a.checkNoBomb(t,s)&&$(e).toggleClass("flag no-bomb")});for(var r=1;r<=this.rows;r++)for(var c=1;c<=this.columns;c++){var l=b(r,c);$(l).addClass("clicked")}}},{key:"debugLog",value:function(e){this.debug&&console.log(e)}},{key:"clearGame",value:function(){this.timer.stopTimer(),this.timer.setTimerToZero()}}])&&C(t.prototype,s),i&&C(t,i),e}();function A(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var B,T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),B=t,console.log("DOMListener"),this.initDomListener()}var t,s,o;return t=e,(s=[{key:"initDomListener",value:function(){console.log("init"),$(n).mousedown(function(){$(n).removeClass("btn-smiley"),$(n).addClass("btn-click")}),$(game).mouseup(function(){$(n).hasClass("btn-wow")?($(n).removeClass("btn-wow"),$(n).addClass("btn-smiley")):$(n).hasClass("btn-click")&&($(n).removeClass("btn-click"),$(n).addClass("btn-smiley"))}),$(n).click(function(){j()}),$("input:radio").click(function(){var e=parseInt($(this).val());console.log(e),$(game).css("zoom",e)}),$(game).on("click",".field",function(){var e=$(this).attr("id"),t=parseInt(e.split("-")[0]),s=parseInt(e.split("-")[1]);B.blockClicked(t,s,"#".concat(e))}),$(game).on("contextmenu",".block",function(){var e=$(this).attr("id");B.flagField("#".concat(e))}),$(game).on("mousedown",".field",function(){$(n).removeClass("btn-smiley"),$(n).addClass("btn-wow")})}}])&&A(t.prototype,s),o&&A(t,o),e}();function F(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var I=0,P=0,G=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Game=t}var t,s,o;return t=e,(s=[{key:"startAI",value:function(){for(P=0,I=0,console.log("start AI");!this.Game.gameWon&&P<this.Game.rows*this.Game.columns;)0===points?this.clickAllBlocks():0===I?this.randomClick():(I=0,this.goThroughClicked()),P++}},{key:"clickAllBlocks",value:function(){$(".field").each(function(){$(this).click()})}},{key:"randomClick",value:function(){var e=[];$(".field").each(function(){e.push("#"+$(this).attr("id"))});var t=Math.floor(Math.random()*e.length),s=e[t];console.log("random click: ",s),$(s).click(),I++}},{key:"goThroughClicked",value:function(){var e=this;$(".clicked").each(function(){var t=parseInt($(this).data("value"));if(t>0){var s=$(this).attr("id"),o=parseInt(s.split("-")[0]),i=parseInt(s.split("-")[1]),n=e.countUnclickedBlocksAround(o,i),a=e.countFlagsAround(o,i);n.length===t&&n.length>0?(flagArray(n),console.log("flag array:",n.length,t),I++):a===t&&0!==a&&clickBlocksAround(o,i)}})}},{key:"countUnclickedBlocksAround",value:function(e,t){return this.checkClicked(e-1,t-1),this.checkClicked(e-1,t),this.checkClicked(e-1,t+1),this.checkClicked(e+1,t-1),this.checkClicked(e+1,t),this.checkClicked(e+1,t+1),this.checkClicked(e,t-1),this.checkClicked(e,t+1),[]}},{key:"countFlagsAround",value:function(e,t){var s=0;return s=this.checkFlag(e-1,t-1,s),s=this.checkFlag(e-1,t,s),s=this.checkFlag(e-1,t+1,s),s=this.checkFlag(e+1,t-1,s),s=this.checkFlag(e+1,t,s),s=this.checkFlag(e+1,t+1,s),s=this.checkFlag(e,t-1,s),s=this.checkFlag(e,t+1,s)}},{key:"checkClicked",value:function(e,t,s){var o=b(e,t);$(o).hasClass("tile")&&s.push(b(e,t))}},{key:"checkFlag",value:function(e,t,s){var o=b(e,t);return $(o).hasClass("block")&&$(o).hasClass("flag")&&s++,s}},{key:"flagArray",value:function(e){e.forEach(function(e){flag(e)})}},{key:"flag",value:function(e){$(e).hasClass("flag")||flagField($(e))}},{key:"clickBlock",value:function(e,t){var s=b(e,t);!$(s).hasClass("block")||$(s).hasClass("clicked")||$(s).hasClass("flag")||($(s).click(),console.log("click:",s),I++)}},{key:"clickBlocksAround",value:function(e,t){clickBlock(e-1,t-1),clickBlock(e-1,t),clickBlock(e-1,t+1),clickBlock(e+1,t-1),clickBlock(e+1,t),clickBlock(e+1,t+1),clickBlock(e,t-1),clickBlock(e,t+1)}}])&&F(t.prototype,s),o&&F(t,o),e}();s.d(t,"newGame",function(){return j});var O,U=!0;function j(){if(void 0!==O)O.clearGame(),O.setupGame();else{O=new w(U),new T(O);var e=new G(O);$("#AI").click(function(){e.startAI()})}}$(document).ready(function(){j()}),$("#newgame-btn").click(function(){j()})}]);